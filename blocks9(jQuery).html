<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Blocks</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>

    <style>
        body {margin-bottom: 50px;}
        .content {
            float: left;
            border: 1px solid gray;
            padding: 8px;

        }
    </style>

    <script type="text/javascript">

    </script>

</head>
<body>


<div class="main">

    <div id="Yellow" class="content" style="background: lightyellow; width: 170px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
    </div>

    <div id="Cyan" class="content" style="background: lightcyan; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>
        <p>
            Proin vitae accumsan felis. Maecenas id luctus arcu, quis pharetra quam. Sed eu enim gravida, hendrerit nisl in, tempor justo. Nunc mollis a enim sed scelerisque. Suspendisse tempor libero a mauris vulputate porta. Cras venenatis quam vel velit laoreet sodales. Proin elementum enim non porta molestie.
        </p>
    </div>
    <div id="Coral" class="content" style="background: lightcoral; width: 170px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>

    </div>

    <div id="Gray" class="content" style="background: lightgray; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>
        <p>
            Proin vitae accumsan felis. Maecenas id luctus arcu, quis pharetra quam. Sed eu enim gravida, hendrerit nisl in, tempor justo. Nunc mollis a enim sed scelerisque. Suspendisse tempor libero a mauris vulputate porta. Cras venenatis quam vel velit laoreet sodales. Proin elementum enim non porta molestie.
        </p>
    </div>

    <div id="Green" class="content" style="background: lightgreen; width: 170px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>

    </div>

    <div id="Pink" class="content" style="background: lightpink; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
    </div>

    <div id="Yellow2" class="content" style="background: lightyellow; width: 170px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
    </div>

    <div id="Cyan2" class="content" style="background: lightcyan; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>
        <p>
            Proin vitae accumsan felis. Maecenas id luctus arcu, quis pharetra quam. Sed eu enim gravida, hendrerit nisl in, tempor justo. Nunc mollis a enim sed scelerisque. Suspendisse tempor libero a mauris vulputate porta. Cras venenatis quam vel velit laoreet sodales. Proin elementum enim non porta molestie.
        </p>
    </div>
    <div id="Coral2" class="content" style="background: lightcoral; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>

    </div>
    <div id="Steel" class="content" style="background: lightsteelblue; width: 170px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
    </div>
    <div id="Yellow3" class="content" style="background: lightyellow; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
    </div>

    <div id="Yellow4" class="content" style="background: lightyellow; width: 170px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
    </div>

    <div id="Cyan4" class="content" style="background: lightcyan; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>
        <p>
            Proin vitae accumsan felis. Maecenas id luctus arcu, quis pharetra quam. Sed eu enim gravida, hendrerit nisl in, tempor justo. Nunc mollis a enim sed scelerisque. Suspendisse tempor libero a mauris vulputate porta. Cras venenatis quam vel velit laoreet sodales. Proin elementum enim non porta molestie.
        </p>
    </div>
    <div id="Coral4" class="content" style="background: lightcoral; width: 270px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
        <p>
            Aenean quis risus justo. Cras finibus tortor vel ligula lacinia, vitae facilisis elit consequat. Fusce lobortis quam lobortis, pulvinar ex non, malesuada eros. Ut dolor orci, ornare vel dignissim a, eleifend ultrices nunc. Fusce felis purus, venenatis et tincidunt sed, ultrices a velit. Morbi pellentesque dui vel hendrerit consequat. Proin eget consequat est.
        </p>

    </div>
    <div id="Steel2" class="content" style="background: lightsteelblue; width: 170px;">

        <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer velit nunc, euismod ut turpis at, sollicitudin porta lectus. Maecenas vehicula, nunc ac elementum feugiat, enim nibh commodo ante, eget dapibus lorem orci vel elit. Ut consequat tortor at arcu vestibulum consectetur.
        </p>
        <p>
            Nulla fringilla ante id interdum ultricies. Nam ac laoreet nibh, vitae maximus arcu. Etiam quam diam, auctor ac tortor sed, dictum consequat leo. Praesent et convallis nibh.  Nunc cursus ante erat, sed tincidunt nibh mattis quis.
        </p>
    </div>

</div>



</body>
<script>
/*
* в плагин вынести фукцию которая будкт
* обрабатывать коллекции
* и доступна далее
* событие должно
* вызывать плагиин / функцию
* */



    (function( $ ){
        var a = {};
        var maxHeight = Math.max.apply(Math,  $('div.content').map(function(){return $(this).height()}).get());
        $.fn.blocksAlign = function() {


        $('div.content').each(function (index, element) {
                $(element).attr("realHeight", Math.round($(element).height()));

                $(element).height(maxHeight);

                if (!a[Math.round($(element).offset().top)]) {
                    a[Math.round($(element).offset().top)] = [];
                }
                a[Math.round($(element).offset().top)].push(element);
                $(element).css('height', Math.max.apply(Math, $(element).map(function () {
                    return $(this).height()
                }).get()));
               // console.log('Индекс элемента div: ' + index + '; id элемента = ' + $(element).attr('id') + '; позиция: ' + $(element).offset().top + '; высота: ' + $(element).attr('realHeight'));
            }
        )
        //console.log(a);
        for (var prop in a) {
            let localMaxHeight = 0;
            //console.log(a[prop].length);

            for (let i = 0; i < a[prop].length; i++) {               //нахожу максимум в строке
                let elemRealHeight = a[prop][i].getAttribute('realHeight');

                if (elemRealHeight > localMaxHeight) {
                    localMaxHeight = elemRealHeight;
                }
            }

            for (let i = 0; i < a[prop].length; i++) {               //уствнавливаю высоту блоков
                a[prop][i].style.height = localMaxHeight + 'px';
            }
        }
    }


        })(jQuery);




    $(window).blocksAlign();




/*
    window.onmousemove = function (e) {
        e = e || window.event;
        if (e.clientY < 8){
            alert("Не уходи!")
        }
        //console.log(e.clientY);

    };


    window.onbeforeunload = function(e) {

        return prompt('dfsdfsdf')
    };

*/

</script>



</html>